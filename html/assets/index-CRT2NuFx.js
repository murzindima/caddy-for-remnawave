import{t as R,c as E,r as i,j as e,S as L,a as g,R as y,o as O,s as p,u as T,L as F,b as _,d as k,e as x}from"./vendor-DHVSyNSs.js";function q(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))d(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&d(n)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function c(...r){return R(E(r))}const I=g("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),b=i.forwardRef(({className:r,variant:s,size:t,asChild:d=!1,...o},a)=>{const n=d?L:"button";return e.jsx(n,{ref:a,className:c(I({variant:s,size:t,className:r})),...o})});b.displayName="Button";const w=i.forwardRef(({className:r,...s},t)=>e.jsx("div",{ref:t,className:c("rounded-xl border bg-card text-card-foreground shadow",r),...s}));w.displayName="Card";const v=i.forwardRef(({className:r,...s},t)=>e.jsx("div",{ref:t,className:c("flex flex-col space-y-1.5 p-6",r),...s}));v.displayName="CardHeader";const j=i.forwardRef(({className:r,...s},t)=>e.jsx("div",{ref:t,className:c("font-semibold leading-none tracking-tight",r),...s}));j.displayName="CardTitle";const P=i.forwardRef(({className:r,...s},t)=>e.jsx("div",{ref:t,className:c("text-sm text-muted-foreground",r),...s}));P.displayName="CardDescription";const N=i.forwardRef(({className:r,...s},t)=>e.jsx("div",{ref:t,className:c("p-6 pt-0",r),...s}));N.displayName="CardContent";const H=i.forwardRef(({className:r,...s},t)=>e.jsx("div",{ref:t,className:c("flex items-center p-6 pt-0",r),...s}));H.displayName="CardFooter";const m=i.forwardRef(({className:r,type:s,...t},d)=>e.jsx("input",{ref:d,type:s,className:c("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...t}));m.displayName="Input";const M=g("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=i.forwardRef(({className:r,...s},t)=>e.jsx(y,{ref:t,className:c(M(),r),...s}));u.displayName=y.displayName;const z=O({email:p().nonempty("Email обязателен").email("Введите корректный email"),password:p().nonempty("Пароль обязателен").min(6,"Пароль должен содержать минимум 6 символов")}),A=()=>{const[r,s]=i.useState(!1),[t,d]=i.useState(null),{register:o,handleSubmit:a,formState:{errors:n}}=T({resolver:_(z)}),C=async S=>{s(!0),d(null);try{const l=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)});if(!l.ok)throw l.status===401?new Error("Неверный email или пароль"):l.status===429?new Error("Слишком много попыток входа. Попробуйте позже"):new Error("Ошибка сервера: ".concat(l.status));const f=await l.json();if(!f.token)throw new Error("Token not found in response");localStorage.setItem("token",f.token),d(null)}catch(l){console.error("Login failed:",l),d(l instanceof Error?l.message:"Произошла ошибка при входе")}finally{s(!1)}};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 p-4",children:e.jsxs(w,{className:"w-full max-w-md",children:[e.jsx(v,{children:e.jsx(j,{className:"text-center text-2xl",children:"Вход в систему"})}),e.jsx(N,{children:e.jsxs("form",{className:"space-y-6",onSubmit:a(C),children:[t&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("p",{className:"text-sm text-red-600",children:t})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",type:"email",...o("email"),className:n.email?"border-red-500":"",disabled:r,placeholder:"example@mail.com"}),n.email&&e.jsx("p",{className:"text-sm text-red-500",children:n.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"password",children:"Пароль"}),e.jsx(m,{id:"password",type:"password",...o("password"),className:n.password?"border-red-500":"",disabled:r,placeholder:"••••••••"}),n.password&&e.jsx("p",{className:"text-sm text-red-500",children:n.password.message})]}),e.jsx(b,{className:"w-full",disabled:r,type:"submit",children:r?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),"Вход..."]}):"Войти"})]})})]})})},V=()=>e.jsx(A,{}),h=document.querySelector("#root");h.innerHTML||k.createRoot(h).render(e.jsx(x.StrictMode,{children:e.jsx(x.Suspense,{fallback:"loading",children:e.jsx(V,{})})}));export{q as __vite_legacy_guard};
